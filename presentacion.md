---
theme: theme.json
author: JoaquÃ­n Velazquez
paging: PÃ¡gina %d / %d
---
# Trabajo PrÃ¡ctico TeÃ³rico

```text


â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ•â•â•â•â–ˆâ–ˆâ•—
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘         â•šâ•â•â•â•â–ˆâ–ˆâ•‘ â•šâ•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ•â•â•â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—         â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
â•šâ•â•  â•šâ•â•â•šâ•â•      â•šâ•â•â•â•â•â•         â•šâ•â•â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• 
                                                             

â”â”â•¸â”â”“â•»â”â”â•¸â”â”â”“â”â”â”“â”â”â”“â•» â•»â•»  â”â”â”“â•ºâ”³â•¸â•»â”â”“â•»â”â”â•¸
â”£â•¸ â”ƒâ”—â”«â”ƒ  â”£â”â”«â”£â”â”›â”—â”â”“â”ƒ â”ƒâ”ƒ  â”£â”â”« â”ƒ â”ƒâ”ƒâ”—â”«â”ƒâ•ºâ”“
â”—â”â•¸â•¹ â•¹â”—â”â•¸â•¹ â•¹â•¹  â”—â”â”›â”—â”â”›â”—â”â•¸â•¹ â•¹ â•¹ â•¹â•¹ â•¹â”—â”â”›
â”â”â”“â”â”â•¸â”â”â•¸â•» â•»â”â”â”“â•»â•ºâ”³â•¸â•» â•»
â”—â”â”“â”£â•¸ â”ƒ  â”ƒ â”ƒâ”£â”³â”›â”ƒ â”ƒ â”—â”³â”›
â”—â”â”›â”—â”â•¸â”—â”â•¸â”—â”â”›â•¹â”—â•¸â•¹ â•¹  â•¹ 
â”â”â”“â”â”â”“â•» â•»â•»  â”â”â”“â”â”â”“â•ºâ”³â”“
â”£â”â”›â”£â”â”«â”—â”³â”›â”ƒ  â”ƒ â”ƒâ”£â”â”« â”ƒâ”ƒ
â•¹  â•¹ â•¹ â•¹ â”—â”â•¸â”—â”â”›â•¹ â•¹â•ºâ”»â”›



```

**Materia:** Redes

**Carrera:** IngenierÃ­a en InformÃ¡tica - FIUBA

**Cuatrimestre:** 2C2024

---

# Ãndice

- ğŸ”Œ IPSec
- ğŸ” Servicios
- ğŸšš Modos
- ğŸ¤ Security Associations
- ğŸ¤– Algoritmos
- ğŸ“¦ Formato del paquete
- ğŸ–Šï¸ Ventajas y desventajas
- ğŸ”§ Casos de uso comunes
- ğŸ”„ Alternativas

---

# ğŸ”Œ IPSec

Conjunto de protocolos de seguridad para la capa de red.

Usa UDP como protocolo de transporte, y normalmente usa el puerto `500`.

## Protocolos

 - Authentication Header (AH)

 - Encapsulating Security Payload (ESP)

 - Security Associations (SA)

---

# ğŸ” Servicios que ofrece 

 * `Confidencialidad` - encripta el *payload* para que la informaciÃ³n del paquete no pueda ser leida por otro individuo.
 * `AutenticaciÃ³n de origen` - asegura que el paquete proviene del origen indicado.
 * `Integridad` - asegura que el contenido del paquete no va a ser modificado.
 * `Anti-replay` - evita que el reenvÃ­o de paquetes interceptados por un agente externo afecte el flujo de datos.
 * `Confidencialidad de flujo de datos (TCP)` - disimula (de manera limitada) la cantidad de paquetes enviados de origen a destino.

---

# ğŸš Modos

## ğŸšš Modo Transporte
```text
â”ŒPaqueteâ”€ESPâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”ŒPaqueteâ”€ESPâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚         â”‚        â”ŒDatosâ”€â”€â”€â”€â”€â”€â”        â”‚â”‚
â”‚ IP      â”‚ ESP    â”‚           â”‚ ESP    â”‚â”‚
â”‚ Header  â”‚ Header â”‚           â”‚ Trailerâ”‚â”‚
â”‚         â”‚        â”‚           â”‚        â”‚â”‚
â”‚         â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš† Modo TÃºnel
```text
â”ŒDatagramaâ”€IPâ”€Nuevoâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        â”ŒPaqueteâ”€ESPâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚        â”‚         â”ŒDatagramaâ”€IPâ”€Originalâ”        â”‚â”‚
â”‚        â”‚         â”‚        â”ŒDatosâ”€â”€â”€â”€â”€â”€â”â”‚        â”‚â”‚
â”‚ IP     â”‚ ESP     â”‚ IP     â”‚           â”‚â”‚ESP     â”‚â”‚
â”‚ Header â”‚ Header  â”‚ Header â”‚           â”‚â”‚Trailer â”‚â”‚
â”‚        â”‚         â”‚        â”‚           â”‚â”‚        â”‚â”‚
â”‚        â”‚         â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚        â”‚â”‚
â”‚        â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ¤ Security Associations

Protocolo para establecer los parÃ¡metros de seguridad entre dos hosts.


---

# ğŸ¤– Algoritmos

---

# ğŸ“¦ Formato del paquete

Dependiendo de los servicios y algoritmos que se utilice, ESP puede agregar
hasta 60 bytes de headers y trailers, sin contar el header estÃ¡ndar de IP.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               Security Parameters Index (SPI)                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Sequence Number                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+---
   |                    IV (optional)                              | ^ p
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | a
   |                    Rest of Payload Data  (variable)           | | y
   ~                                                               ~ | l
   |                                                               | | o
   +               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | a
   |               |         TFC Padding * (optional, variable)    | v d
   +-+-+-+-+-+-+-+-+         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+---
   |                         |        Padding (0-255 bytes)        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                               |  Pad Length   | Next Header   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Integrity Check Value-ICV   (variable)                |
   ~                                                               ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```


- Una vez definidos los algoritmos y servicios, la estructura del paquete se
  mantiene fija.

---

## Definiciones

##### Security Parameters Index
NÃºmero que permite que el receiver identifique a que SA pertenece el paquete.
Lo define el receiver y arranca desde 256 (0-255 estÃ¡n reservados).

##### NÃºmero de secuencia
Es parte del servicio Anti Replay y actÃºa como el nÃºmero de secuencia en 
conexiones TCP. Siempre empieza desde 0.

Puede extenderse a 64 bits, con los 32 bits superiores siendo implÃ­citos (tanto
el receiver como el sender mantienen la cuenta).

##### Initialization Vector (IV)
Campo para los algoritmos de encriptaciÃ³n que necesiten informaciÃ³n adicional.
Se considera parte del payload.

##### Padding
Se utiliza en casos en donde los datos del payload no terminan en un nÃºmero de
bytes divisible por 4 (necesario para la estructura del paquete ESP). Pero
ademÃ¡s, algunos algoritmos de encriptado pueden necesitar que la informaciÃ³n
sea de un mÃºltiplo especÃ­fico. El padding puede ser de 0 a 255 bytes, y su
contenido es una secuencia del estilo 1,2,3, .... El tamaÃ±o del padding
aplicado se puede ver en el siguiente campo de 1 byte, llamado Pad Length.

##### Next Header
El cÃ³digo del siguiente protocolo presente en el payload. Es similar al campo
presente en el header IP. El cÃ³digo 59 se utiliza para indicar que no hay
siguiente protocolo. Este tipo de paquete se denomina dummy.

Los paquetes dummy se pueden utilizar para enmascarar la ausencia de trÃ¡fico.
Para esto, se puede modelar el trÃ¡fico para que siga una distribuciÃ³n
especÃ­fica, agregando dummies en momentos en donde no hay informaciÃ³n que
envÃ­ar.

##### TFC Padding
Padding adicional para cumplir con los requisitos del servicio de Traffic Flow
Confidentiality (TFC). Este padding, a diferencia del anteriormente mencionado,
no tiene lÃ­mite, y permite esconder el verdadero tamaÃ±o del paquete. Para
agregarlo, es necesario que dentro del payload se especifique el verdadero
tamaÃ±o del datagrama.

##### Integrity Check Value (ICV)
Es parte del servicio de integridad. Tiene tamaÃ±o variado y su valor depende
del algoritmo de integridad (o de modo combinado) utilizado.

---

# ğŸ‘ Ventajas y desventajas

---

# ğŸ”„ Alternativas

 - Authentication Header (AH)
 - TLS
